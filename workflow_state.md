# Workflow State

current_phase: Phase 3 drawings & MBD

completed_items:
- Added CAD_BUILD_PYTHON option and python bindings scaffold.
- Created pybind11 module stub.
- Added initial Python package and PlannerAgent stub.
- Added Executor/Validator/Reflector/Historian skeletons.
- Added WorkflowEngine loop with plan/execute/validate/reflect.
- Added logging framework, crash reporter stub, and undo stack abstraction.
- Added Windows build documentation.
- Added .gitignore for Windows/CMake/vcpkg/Python artifacts.
- Added Windows CI configure-only workflow.
- Added NSIS installer script scaffold.
- Added .cursorcad rules file and parser.
- Added workflow state loader in Python engine.
- Added CLI runner for multi-agent workflow loop.
- Added Qt AI console and agent thoughts panel.
- Added kernel and simulation module scaffolding.
- Added smoke test for kernel/simulation linking.
- Added Qt main window viewport placeholder.
- Added ribbon tabs/groups and QAction registration.
- Wired ribbon actions to command line and property panel context.
- Added browser tree sections and recent command list.
- Added property panel context categories for ribbon commands.
- Added log panel to track UI command activity.
- Added property panel form placeholders per command context.
- Added viewport status updates for command feedback.
- Added viewport navigation hint placeholder text.
- Added status bar labels for workspace mode and document.
- Set minimum widths for primary dock panels.
- Added UI layout persistence with QSettings.
- Added viewport navigation toolbar buttons (UI-only).
- Restricted dock areas for layout consistency.
- Added command line history navigation.
- Added ribbon tab metadata table for tooltips and grouping.
- Added command line enter-to-run UI feedback.
- Added workspace tab change syncing for mode and context.
- Added default keyboard shortcuts for common commands.
- Added base UI style sheet and resource loading.
- Phase 1 UI shell complete (Ribbon, panels, viewport placeholder).
- Added performance monitor stub and FPS placeholder.
- Added assembly manager scaffolding for LOD and limits.
- Added interference checker stub and UI hook.
- Added IO pipeline stub for unified import/export.
- Added assembly cache stats and load stub.
- Added background loading flag to assembly manager.
- Added performance panel with FPS/cache display.
- Added UI LOD selector in performance panel.
- Added background loading toggle in performance panel.
- Wired LOD/background toggles to assembly manager.
- Added assembly load queue stub and progress polling.
- Added performance panel load progress indicator.
- Added IO format metadata for export labels.
- Added IO format support checks in pipeline.
- Added target FPS slider in performance panel.
- Phase 2 scaffolding progressing (performance + IO + assembly).
- Added perf timing stub for assembly load.
- Added explicit assembly load command in ribbon.
- Synced target FPS indicator with status bar.
- Phase 2 scaffolding mostly complete (pending full LOD/perf).
- Added drawing document skeleton models and TechDraw adapter stubs.
- Added drawing styles, BOM, and annotation stubs.
- Added associative link placeholders in drawing model and bridge.
- Added drawing dimension stubs and TechDraw hooks.
- Added PMI data structures and default MBD dataset.
- Added associative flag on drawing views.
- Added associative flag on drawing sheets and extra dimensions.
- Updated drawing property panel fields for BOM and sheet.
- Added BOM part numbers and dimension tolerances.
- Added drawing sheet scale label and annotations.
- Added drawing style profiles for style mapping.
- Added view-level style profile field.
- Added associative update service for drawings.
- Added LOD recommendation helper for large assemblies.
- Normalized LOD selection labels for handler.
- Initialized assembly manager LOD defaults on startup.
- Added status bar FPS indicator bound to viewport.
- Docked AI panels into tabs for UI layout clarity.
- Expanded BOM service to extract components from Assembly objects with quantity counting and part number generation.
- Expanded annotation service with multiple annotation types (Text, Note, Callout, Balloon, Revision, Title).
- Added annotation positioning options (alignment, rotation, font size, style).
- Added view-attached annotations and sheet annotation builders.

pending_items:
- FreeCAD/OCCT/Qt/Coin3D bindings and full feature mapping.
- 3D viewport integration with Coin3D or OpenCascade viewer.
- Large assembly LOD/caching implementation.
- Collision/interference checks (full).
- Drawing styles framework expansion (additional style types and customization).
- BOM pipeline UI integration and assembly registry lookup.
- Annotation positioning refinement (leader lines, attachment points).
- MBD 3D annotation rendering hook.
- Ribbon command wiring to actual CAD operations.

decisions_made:
- Keep FreeCAD on master branch for feature parity.
- Use vcpkg as default dependency provider.
- pybind11 used for C++/Python bindings.
- Document Windows build with MSVC/Clang-CL guidance.
- Added minimal C++ smoke test to validate kernel/simulation linking.
- Windows configure not run in this environment; CI covers configure-only.
- 3D viewport placeholder uses Qt frame with centered label.
- Ribbon uses QAction registry with grouped tabs.
- Ribbon triggers update command line and UI context placeholder.
- Browser tree tracks recent commands for UI-only feedback.
- Property panel uses stacked placeholder panels for context categories.
- UI log panel added as bottom dock widget.
- Property panel uses placeholder form fields per context.
- Viewport status text reflects last UI command.
- Viewport shows basic navigation hint for UI-only stage.
- Status bar reflects workspace mode and active document.
- Dock panels enforce minimum widths for layout stability.
- Persist window geometry and dock layout per user.
- Viewport navigation buttons update placeholder status.
- Dock areas constrained to preserve UI layout parity.
- Command history capped at 20 entries for UI clarity.
- Ribbon tabs defined via static configuration table.
- Command line enter updates UI context without CAD logic.
- Workspace mode follows ribbon tab selection.
- Shortcuts added for frequent sketch/part/assembly actions.
- UI uses QSS resource for Inventor-like theme.
- FPS shown as simulated value until real render loop exists.
- Interference checks currently return stubbed results.
- IO pipeline abstracts format handling from UI commands.
- Assembly cache stats are stubbed for perf scaffolding.
- Background loading flag is exposed for future async load.
- FPS label shows simulated viewport updates until render loop exists.
- Performance panel shares FPS/cache with status bar.
- LOD selection currently updates UI status only.
- Background loading toggle updates UI status only.
- LOD selection now updates assembly manager state.
- Assembly load queue uses coarse 25% progress ticks.
- Load progress indicator uses queued progress percent.
- Export uses IO pipeline format labels in UI status.
- IO pipeline exposes support checks for import/export.
- Target FPS slider updates assembly manager target.
- Assembly load timing uses PerfTimer stub.
- Assembly load is queued via dedicated command.
- Status bar now shows target FPS when adjusted.
- LOD recommendation uses component count and target FPS.
- Drawing documents include standard view placeholders.
- Drawing stubs use default styles and basic annotations.
- Drawing document stores source model id for associative links.
- Dimensions stored in drawing document alongside annotations.
- PMI dataset includes datum, tolerance, and annotation stubs.
- Drawing views default to associative updates.
- Drawing sheets default to associative updates.
- Dimension stubs include simple tolerances.
- Drawing sheets include scale label for UI binding.
- Style profiles map line/text styles by name.
- Views reference style profiles by name for UI binding.
- Drawing document tracks revision and last update id.
- Drawing context panel includes BOM field placeholder.
- LOD handler expects lowercase labels.
- Assembly LOD defaults to Simplified for Phase 2 demo.
- Property/AI console and log/thought panels are tabified for space.
- BOM service extracts components from Assembly objects and counts quantities.
- BOM part numbers generated automatically from part names with index suffix.
- BOM items sorted alphabetically by part name for consistent ordering.
- Annotation types include Text, Note, Callout, Balloon, Revision, and Title.
- Annotations support alignment (Left, Center, Right, Justified), rotation, and font size.
- Annotations can be attached to views or placed on sheets independently.
- AnnotationService provides factory methods for creating different annotation types.

estimated_remaining_time: 70-110 weeks
